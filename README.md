# Track Parser - Radio Track Preparation Application

РџРѕР»РЅРѕС†РµРЅРЅРѕРµ РІРµР±-РїСЂРёР»РѕР¶РµРЅРёРµ РґР»СЏ Р°РІС‚РѕРјР°С‚РёР·Р°С†РёРё РїРѕРґРіРѕС‚РѕРІРєРё Р°СѓРґРёРѕС‚СЂРµРєРѕРІ РґР»СЏ СЂР°РґРёРѕ РЅР° Р±Р°Р·Рµ Next.js СЃ TypeScript.

## Р’РѕР·РјРѕР¶РЅРѕСЃС‚Рё

- **РЎРєР°С‡РёРІР°РЅРёРµ С‚СЂРµРєРѕРІ**: РџРѕРґРґРµСЂР¶РєР° YouTube (С‡РµСЂРµР· RapidAPI) Рё РЇРЅРґРµРєСЃ РњСѓР·С‹РєРё (С‡РµСЂРµР· yt-dlp)
- **РџСЂРѕСЃР»СѓС€РёРІР°РЅРёРµ Рё РѕС‚Р±РѕСЂ**: Р’СЃС‚СЂРѕРµРЅРЅС‹Р№ Р°СѓРґРёРѕРїР»РµРµСЂ СЃ РєРЅРѕРїРєР°РјРё РїСЂРёРЅСЏС‚РёСЏ/РѕС‚РєР»РѕРЅРµРЅРёСЏ
- **РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРѕРµ РѕРїСЂРµРґРµР»РµРЅРёРµ С‚РёРїР° С‚СЂРµРєР°**: РџРѕ РґР»РёС‚РµР»СЊРЅРѕСЃС‚Рё Рё BPM (Р‘С‹СЃС‚СЂС‹Р№/РЎСЂРµРґРЅРёР№/РњРµРґР»РµРЅРЅС‹Р№)
- **РћР±СЂРµР·РєР° С‚СЂРµРєРѕРІ**: РђРІС‚РѕРјР°С‚РёС‡РµСЃРєР°СЏ РѕР±СЂРµР·РєР° РґРѕ 6 РјРёРЅСѓС‚ (С‚СЂРµР±СѓРµС‚ FFmpeg)
- **Р РµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…**: РџРѕР»РЅС‹Р№ СЂРµРґР°РєС‚РѕСЂ СЃ С‚РµРіРёСЂРѕРІР°РЅРёРµРј
- **FTP Р·Р°РіСЂСѓР·РєР°**: Р—Р°РіСЂСѓР·РєР° РѕР±СЂР°Р±РѕС‚Р°РЅРЅС‹С… С‚СЂРµРєРѕРІ РЅР° СЃРµСЂРІРµСЂ
- **РџСЂРѕРІРµСЂРєР° В«РќР° СЂР°РґРёРѕВ»**: РЎРѕРїРѕСЃС‚Р°РІР»РµРЅРёРµ СЃ РїР»РµР№Р»РёСЃС‚РѕРј Streaming.Center (РїР»РµР№Р»РёСЃС‚ id=1), Р±РµР№РґР¶ РІ СЃРїРёСЃРєРµ С‚СЂРµРєРѕРІ
- **РџСЂРѕРіСЂРµСЃСЃ-Р±Р°СЂС‹**: РћС‚РѕР±СЂР°Р¶РµРЅРёРµ РїСЂРѕРіСЂРµСЃСЃР° РґР»СЏ РІСЃРµС… РѕРїРµСЂР°С†РёР№
- **РћСЂРіР°РЅРёР·Р°С†РёСЏ С„Р°Р№Р»РѕРІ**: РђРІС‚РѕРјР°С‚РёС‡РµСЃРєРѕРµ СѓРїСЂР°РІР»РµРЅРёРµ РїР°РїРєР°РјРё
- **вњ… РџРѕР»РЅР°СЏ РїРѕРґРґРµСЂР¶РєР° Netlify**: Р’СЃРµ С„СѓРЅРєС†РёРё СЂР°Р±РѕС‚Р°СЋС‚ СЃ FFmpeg.wasm (WebAssembly РІРµСЂСЃРёСЏ FFmpeg)

## РўСЂРµР±РѕРІР°РЅРёСЏ

- Node.js 20+ (СѓРєР°Р·Р°РЅРѕ РІ package.json)
- Yarn 4.12.0+
- FFmpeg (РґР»СЏ РѕР±СЂР°Р±РѕС‚РєРё Р°СѓРґРёРѕ) - РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ, РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ FFmpeg.wasm РїРѕ СѓРјРѕР»С‡Р°РЅРёСЋ
- yt-dlp (РґР»СЏ СЃРєР°С‡РёРІР°РЅРёСЏ С‚СЂРµРєРѕРІ) - РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ, С‚СЂРµР±СѓРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РґР»СЏ YouTube Music Рё РЇРЅРґРµРєСЃ.РњСѓР·С‹РєРё

**РџР»Р°С‚С„РѕСЂРјС‹:** Windows, Linux, macOS (РєСЂРѕСЃСЃРїР»Р°С‚С„РѕСЂРјРµРЅРЅР°СЏ РїРѕРґРґРµСЂР¶РєР°)

**Р”РµРїР»РѕР№:** вњ… Netlify, вњ… Vercel (СЃ FFmpeg.wasm), VPS, РІС‹РґРµР»РµРЅРЅС‹Р№ СЃРµСЂРІРµСЂ

**РћР±СЂР°Р±РѕС‚РєР° Р°СѓРґРёРѕ:** РСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ FFmpeg.wasm (WebAssembly) - СЂР°Р±РѕС‚Р°РµС‚ РІРµР·РґРµ, РІРєР»СЋС‡Р°СЏ Netlify, Р±РµР· СѓСЃС‚Р°РЅРѕРІРєРё Р±РёРЅР°СЂРЅС‹С… С„Р°Р№Р»РѕРІ

## РЈСЃС‚Р°РЅРѕРІРєР° Рё РЅР°СЃС‚СЂРѕР№РєР°

### 1. РљР»РѕРЅРёСЂРѕРІР°РЅРёРµ СЂРµРїРѕР·РёС‚РѕСЂРёСЏ

```bash
git clone <repository-url>
cd Track_parser
```

### 2. РЈСЃС‚Р°РЅРѕРІРєР° Р·Р°РІРёСЃРёРјРѕСЃС‚РµР№

```bash
yarn install
```

### 3. РќР°СЃС‚СЂРѕР№РєР° РїРµСЂРµРјРµРЅРЅС‹С… РѕРєСЂСѓР¶РµРЅРёСЏ

РЎРєРѕРїРёСЂСѓР№С‚Рµ С„Р°Р№Р» `.env.example` РІ `.env` Рё Р·Р°РїРѕР»РЅРёС‚Рµ РІР°С€Рё API РєР»СЋС‡Рё:

```bash
cp .env.example .env
```

РћС‚СЂРµРґР°РєС‚РёСЂСѓР№С‚Рµ `.env` С„Р°Р№Р»:

```env
# RapidAPI Configuration
RAPIDAPI_KEY=your_rapidapi_key_here
RAPIDAPI_HOST=youtube-mp36.p.rapidapi.com

# FTP Configuration
FTP_HOST=s.ruworship.ru
FTP_PORT=21
FTP_USER=radio
FTP_PASSWORD=your_ftp_password_here
FTP_SECURE=false
FTP_REMOTE_PATH=/media/Server_1/0 0 ALL_TRACK  # Optional: remote directory on FTP server

# FFmpeg Configuration (optional)
# FFMPEG_PATH=C:\ffmpeg\bin

# Streaming.Center (РїСЂРѕРІРµСЂРєР° В«С‚СЂРµРє СѓР¶Рµ РЅР° СЂР°РґРёРѕВ», РїР»РµР№Р»РёСЃС‚ В«РІСЃРµ С‚СЂРµРєРёВ»)
STREAMING_CENTER_API_URL=https://your-server.streaming.center:1030
STREAMING_CENTER_API_KEY=your_api_key_here
# STREAMING_CENTER_PLAYLIST_ID=1
```

**Streaming.Center (РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ):** РґР»СЏ РїСЂРѕРІРµСЂРєРё В«С‚СЂРµРє СѓР¶Рµ РЅР° СЂР°РґРёРѕВ» РІ РїР»РµР№Р»РёСЃС‚Рµ СѓРєР°Р¶РёС‚Рµ:
- `STREAMING_CENTER_API_URL` вЂ” Р±Р°Р·РѕРІС‹Р№ URL (РЅР°РїСЂРёРјРµСЂ `https://your-server.streaming.center:1030`)
- `STREAMING_CENTER_API_KEY` вЂ” РєР»СЋС‡ API
- `STREAMING_CENTER_PLAYLIST_ID` вЂ” ID РїР»РµР№Р»РёСЃС‚Р° СЃРѕ РІСЃРµРјРё С‚СЂРµРєР°РјРё (РїРѕ СѓРјРѕР»С‡Р°РЅРёСЋ 1)

Р‘РµР· СЌС‚РёС… РїРµСЂРµРјРµРЅРЅС‹С… РїСЂРѕРІРµСЂРєР° РѕС‚РєР»СЋС‡РµРЅР°, Р±РµР№РґР¶ В«РќР° СЂР°РґРёРѕВ» РЅРµ РїРѕРєР°Р·С‹РІР°РµС‚СЃСЏ.

**Р’Р°Р¶РЅРѕ:** 
- РџРѕР»СѓС‡РёС‚Рµ РІР°С€ RapidAPI РєР»СЋС‡ РЅР° [rapidapi.com](https://rapidapi.com/)
- РќР°СЃС‚СЂРѕР№РєРё FTP С…СЂР°РЅСЏС‚СЃСЏ РІ `.env` РґР»СЏ Р±РµР·РѕРїР°СЃРЅРѕСЃС‚Рё (РїР°СЂРѕР»СЊ РЅРµ РґРѕР»Р¶РµРЅ РїРѕРїР°РґР°С‚СЊ РІ СЂРµРїРѕР·РёС‚РѕСЂРёР№)

### 4. РЈСЃС‚Р°РЅРѕРІРєР° FFmpeg Рё yt-dlp

#### Windows

1. **FFmpeg:**
   - РЎРєР°С‡Р°Р№С‚Рµ FFmpeg СЃ [РѕС„РёС†РёР°Р»СЊРЅРѕРіРѕ СЃР°Р№С‚Р°](https://ffmpeg.org/download.html)
   - Р Р°СЃРїР°РєСѓР№С‚Рµ РІ `C:\ffmpeg\` РёР»Рё РґРѕР±Р°РІСЊС‚Рµ РІ PATH
   - РР»Рё СѓРєР°Р¶РёС‚Рµ РїСѓС‚СЊ РІ `config.json` РёР»Рё РїРµСЂРµРјРµРЅРЅРѕР№ РѕРєСЂСѓР¶РµРЅРёСЏ `FFMPEG_PATH`

2. **yt-dlp:**
   - РЎРєР°С‡Р°Р№С‚Рµ `yt-dlp.exe` Рё РїРѕРјРµСЃС‚РёС‚Рµ РІ РїР°РїРєСѓ `bin/` РїСЂРѕРµРєС‚Р°

#### Linux

1. **FFmpeg:**
   ```bash
   # Ubuntu/Debian
   sudo apt-get update
   sudo apt-get install ffmpeg

   # РР»Рё СѓРєР°Р¶РёС‚Рµ РїСѓС‚СЊ РІ config.json РёР»Рё РїРµСЂРµРјРµРЅРЅРѕР№ РѕРєСЂСѓР¶РµРЅРёСЏ FFMPEG_PATH
   ```

2. **yt-dlp:**
   ```bash
   # РЈСЃС‚Р°РЅРѕРІРєР° С‡РµСЂРµР· pip (СЂРµРєРѕРјРµРЅРґСѓРµС‚СЃСЏ)
   pip install yt-dlp

   # РР»Рё СЃРєР°С‡Р°Р№С‚Рµ Р±РёРЅР°СЂРЅРёРє Рё РїРѕРјРµСЃС‚РёС‚Рµ РІ РїР°РїРєСѓ bin/ РїСЂРѕРµРєС‚Р°
   wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O bin/yt-dlp
   chmod +x bin/yt-dlp
   ```

#### РќР°СЃС‚СЂРѕР№РєР° РїСѓС‚Рё Рє FFmpeg (РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ)

Р’С‹ РјРѕР¶РµС‚Рµ СѓРєР°Р·Р°С‚СЊ РїСѓС‚СЊ Рє FFmpeg РѕРґРЅРёРј РёР· СЃРїРѕСЃРѕР±РѕРІ:

1. **Р§РµСЂРµР· РїРµСЂРµРјРµРЅРЅСѓСЋ РѕРєСЂСѓР¶РµРЅРёСЏ:**
   ```bash
   export FFMPEG_PATH=/usr/bin  # Linux
   # РёР»Рё
   set FFMPEG_PATH=C:\ffmpeg\bin  # Windows
   ```

2. **Р§РµСЂРµР· config.json:**
   ```json
   {
     "ffmpeg": {
       "path": "/usr/bin"  // Linux РёР»Рё "C:\\ffmpeg\\bin" РґР»СЏ Windows
     }
   }
   ```

### 5. РџСЂРѕРІРµСЂРєР° FFmpeg

```bash
yarn check
```

### 6. Р—Р°РїСѓСЃРє РїСЂРёР»РѕР¶РµРЅРёСЏ

```bash
yarn dev
```

РџСЂРёР»РѕР¶РµРЅРёРµ Р±СѓРґРµС‚ РґРѕСЃС‚СѓРїРЅРѕ РїРѕ Р°РґСЂРµСЃСѓ: http://localhost:3000

## РЎС‚СЂСѓРєС‚СѓСЂР° РїСЂРѕРµРєС‚Р°

```
track-parser/
в”њв”Ђв”Ђ app/
в”‚   в”њв”Ђв”Ђ api/                    # API РјР°СЂС€СЂСѓС‚С‹
в”‚   в”‚   в”њв”Ђв”Ђ audio/[trackId]/    # РЎР»СѓР¶РµРЅРёРµ Р°СѓРґРёРѕС„Р°Р№Р»РѕРІ
в”‚   в”‚   в”њв”Ђв”Ђ download/           # РЎРєР°С‡РёРІР°РЅРёРµ С‚СЂРµРєРѕРІ
в”‚   в”‚   в”њв”Ђв”Ђ process-track/      # РћР±СЂР°Р±РѕС‚РєР° С‚СЂРµРєРѕРІ
в”‚   в”‚   в”њв”Ђв”Ђ reject-track/       # РћС‚РєР»РѕРЅРµРЅРёРµ С‚СЂРµРєРѕРІ
в”‚   в”‚   в”њв”Ђв”Ђ test-ftp/           # РўРµСЃС‚ FTP СЃРѕРµРґРёРЅРµРЅРёСЏ
в”‚   в”‚   в”њв”Ђв”Ђ tracks/             # РџРѕР»СѓС‡РµРЅРёРµ СЃРїРёСЃРєР° С‚СЂРµРєРѕРІ
в”‚   в”‚   в”њв”Ђв”Ђ update-metadata/    # РћР±РЅРѕРІР»РµРЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…
в”‚   в”‚   в””в”Ђв”Ђ upload-ftp/         # Р—Р°РіСЂСѓР·РєР° РЅР° FTP
в”‚   в”њв”Ђв”Ђ components/             # React РєРѕРјРїРѕРЅРµРЅС‚С‹
в”‚   в”‚   в”њв”Ђв”Ђ DownloadTrack.tsx   # РљРѕРјРїРѕРЅРµРЅС‚ СЃРєР°С‡РёРІР°РЅРёСЏ
в”‚   в”‚   в”њв”Ђв”Ђ TrackPlayer.tsx     # РђСѓРґРёРѕРїР»РµРµСЂ
в”‚   в”‚   в”њв”Ђв”Ђ MetadataEditor.tsx  # Р РµРґР°РєС‚РѕСЂ РјРµС‚Р°РґР°РЅРЅС‹С…
в”‚   в”‚   в””в”Ђв”Ђ FtpUploader.tsx     # FTP Р·Р°РіСЂСѓР·С‡РёРє
в”‚   в”њв”Ђв”Ђ globals.css             # Р“Р»РѕР±Р°Р»СЊРЅС‹Рµ СЃС‚РёР»Рё
в”‚   в”њв”Ђв”Ђ layout.tsx              # РљРѕСЂРЅРµРІРѕР№ layout
в”‚   в””в”Ђв”Ђ page.tsx                # Р“Р»Р°РІРЅР°СЏ СЃС‚СЂР°РЅРёС†Р°
в”њв”Ђв”Ђ lib/                        # Р‘РёР±Р»РёРѕС‚РµС‡РЅС‹Рµ С„СѓРЅРєС†РёРё
в”‚   в”њв”Ђв”Ђ config.ts               # РЈРїСЂР°РІР»РµРЅРёРµ РєРѕРЅС„РёРіСѓСЂР°С†РёРµР№
в”‚   в””в”Ђв”Ђ processTracks.ts        # Р›РѕРіРёРєР° РѕР±СЂР°Р±РѕС‚РєРё С‚СЂРµРєРѕРІ
в”њв”Ђв”Ђ types/                      # TypeScript С‚РёРїС‹
в”‚   в””в”Ђв”Ђ track.ts                # РўРёРїС‹ РґР»СЏ С‚СЂРµРєРѕРІ
в”њв”Ђв”Ђ config.json                 # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ РїСЂРёР»РѕР¶РµРЅРёСЏ
в”њв”Ђв”Ђ next.config.js              # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ Next.js
в”њв”Ђв”Ђ package.json                # Р—Р°РІРёСЃРёРјРѕСЃС‚Рё
в”њв”Ђв”Ђ postcss.config.js           # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ PostCSS
в”њв”Ђв”Ђ tailwind.config.js          # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ Tailwind CSS
в”њв”Ђв”Ђ tsconfig.json               # РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ TypeScript
в””в”Ђв”Ђ README.md                   # Р”РѕРєСѓРјРµРЅС‚Р°С†РёСЏ
```

## РСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ

### 1. РЎРєР°С‡РёРІР°РЅРёРµ С‚СЂРµРєРѕРІ

1. РџРµСЂРµР№РґРёС‚Рµ РЅР° РІРєР»Р°РґРєСѓ "Download Tracks"
2. Р’С‹Р±РµСЂРёС‚Рµ РёСЃС‚РѕС‡РЅРёРє (YouTube РёР»Рё YouTube Music)
3. Р’РІРµРґРёС‚Рµ URL С‚СЂРµРєР°
4. РќР°Р¶РјРёС‚Рµ "Download Track"
5. РћС‚СЃР»РµР¶РёРІР°Р№С‚Рµ РїСЂРѕРіСЂРµСЃСЃ СЃРєР°С‡РёРІР°РЅРёСЏ

### 2. РџСЂРѕСЃР»СѓС€РёРІР°РЅРёРµ Рё РѕС‚Р±РѕСЂ

1. РџРµСЂРµР№РґРёС‚Рµ РЅР° РІРєР»Р°РґРєСѓ "Listen & Review"
2. Р’С‹Р±РµСЂРёС‚Рµ С‚СЂРµРє РёР· СЃРїРёСЃРєР° СЃРєР°С‡Р°РЅРЅС‹С…
3. РСЃРїРѕР»СЊР·СѓР№С‚Рµ Р°СѓРґРёРѕРїР»РµРµСЂ РґР»СЏ РїСЂРѕСЃР»СѓС€РёРІР°РЅРёСЏ
4. РќР°Р¶РјРёС‚Рµ "Accept Track" РёР»Рё "Reject Track"

### 3. Р РµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…

1. РџРµСЂРµР№РґРёС‚Рµ РЅР° РІРєР»Р°РґРєСѓ "Edit Metadata"
2. Р’С‹Р±РµСЂРёС‚Рµ РѕР±СЂР°Р±РѕС‚Р°РЅРЅС‹Р№ С‚СЂРµРє
3. РћС‚СЂРµРґР°РєС‚РёСЂСѓР№С‚Рµ РјРµС‚Р°РґР°РЅРЅС‹Рµ:
   - РќР°Р·РІР°РЅРёРµ
   - РђСЂС‚РёСЃС‚
   - РђР»СЊР±РѕРј
   - РўРёРї С‚СЂРµРєР° (Р‘С‹СЃС‚СЂС‹Р№/РЎСЂРµРґРЅРёР№/РњРµРґР»РµРЅРЅС‹Р№)
   - Р РµР№С‚РёРЅРі (1-10)
   - Р“РѕРґ
4. РќР°Р¶РјРёС‚Рµ "Save Metadata"

### 4. Р—Р°РіСЂСѓР·РєР° РЅР° FTP

1. РџРµСЂРµР№РґРёС‚Рµ РЅР° РІРєР»Р°РґРєСѓ "FTP Upload"
2. РќР°СЃС‚СЂРѕР№С‚Рµ FTP РїР°СЂР°РјРµС‚СЂС‹:
   - Host
   - Port
   - Username
   - Password
   - Secure connection (РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ)
3. РќР°Р¶РјРёС‚Рµ "Test Connection" РґР»СЏ РїСЂРѕРІРµСЂРєРё
4. Р’С‹Р±РµСЂРёС‚Рµ С‚СЂРµРєРё РґР»СЏ Р·Р°РіСЂСѓР·РєРё РёР»Рё РЅР°Р¶РјРёС‚Рµ "Upload All Tracks"

## РћСЂРіР°РЅРёР·Р°С†РёСЏ С„Р°Р№Р»РѕРІ

РџСЂРёР»РѕР¶РµРЅРёРµ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё СЃРѕР·РґР°РµС‚ Рё СѓРїСЂР°РІР»СЏРµС‚ СЃР»РµРґСѓСЋС‰РёРјРё РїР°РїРєР°РјРё:

- `downloads/` - РЎРєР°С‡Р°РЅРЅС‹Рµ С‚СЂРµРєРё
- `processed/` - РћР±СЂР°Р±РѕС‚Р°РЅРЅС‹Рµ С‚СЂРµРєРё
- `rejected/` - РћС‚РєР»РѕРЅРµРЅРЅС‹Рµ С‚СЂРµРєРё
- `server_upload/` - РўСЂРµРєРё РґР»СЏ Р·Р°РіСЂСѓР·РєРё РЅР° СЃРµСЂРІРµСЂ

## API Endpoints

- `GET /api/tracks` - РџРѕР»СѓС‡РµРЅРёРµ СЃРїРёСЃРєР° С‚СЂРµРєРѕРІ
- `POST /api/download` - РЎРєР°С‡РёРІР°РЅРёРµ С‚СЂРµРєР°
- `POST /api/process-track` - РћР±СЂР°Р±РѕС‚РєР° С‚СЂРµРєР°
- `POST /api/reject-track` - РћС‚РєР»РѕРЅРµРЅРёРµ С‚СЂРµРєР°
- `POST /api/update-metadata` - РћР±РЅРѕРІР»РµРЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…
- `POST /api/upload-ftp` - Р—Р°РіСЂСѓР·РєР° РЅР° FTP
- `POST /api/test-ftp` - РўРµСЃС‚ FTP СЃРѕРµРґРёРЅРµРЅРёСЏ
- `POST /api/radio/check-batch` - РџСЂРѕРІРµСЂРєР°, РєР°РєРёРµ С‚СЂРµРєРё СѓР¶Рµ РµСЃС‚СЊ РІ РїР»РµР№Р»РёСЃС‚Рµ Streaming.Center
- `GET /api/audio/[trackId]` - РџРѕР»СѓС‡РµРЅРёРµ Р°СѓРґРёРѕС„Р°Р№Р»Р°

## РўРµС…РЅРѕР»РѕРіРёРё

- **Frontend**: Next.js 14, React 18, TypeScript
- **Styling**: Tailwind CSS
- **Audio Processing**: FFmpeg, fluent-ffmpeg
- **Download**: ytdl-core
- **FTP**: basic-ftp
- **File Management**: fs-extra
- **Audio Metadata**: node-audiotags

## Р Р°Р·СЂР°Р±РѕС‚РєР°

### РљРѕРјР°РЅРґС‹

```bash
yarn dev          # Р—Р°РїСѓСЃРє РІ СЂРµР¶РёРјРµ СЂР°Р·СЂР°Р±РѕС‚РєРё
yarn build        # РЎР±РѕСЂРєР° РґР»СЏ РїСЂРѕРґР°РєС€РµРЅР°
yarn start        # Р—Р°РїСѓСЃРє РїСЂРѕРґР°РєС€РµРЅ РІРµСЂСЃРёРё
yarn lint         # РџСЂРѕРІРµСЂРєР° РєРѕРґР°
```

### РџРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ

РЎРѕР·РґР°Р№С‚Рµ С„Р°Р№Р» `.env.local` РґР»СЏ Р»РѕРєР°Р»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє:

```env
NEXT_PUBLIC_API_URL=http://localhost:3000
```

## Р”РµРїР»РѕР№

### Р”РµРїР»РѕР№ РЅР° Vercel

вњ… **РџСЂРѕРµРєС‚ РїРѕРґРґРµСЂР¶РёРІР°РµС‚ РґРµРїР»РѕР№ РЅР° [Vercel](https://vercel.com).**

1. РџРѕРґРєР»СЋС‡РёС‚Рµ СЂРµРїРѕР·РёС‚РѕСЂРёР№ Рє Vercel.
2. Р”РѕР±Р°РІСЊС‚Рµ РїРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ (Supabase, RapidAPI, FTP) вЂ” СЃРј. [VERCEL_DEPLOY.md](./VERCEL_DEPLOY.md).
3. Р”РµРїР»РѕР№ РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїСЂРё `git push`.

РћРіСЂР°РЅРёС‡РµРЅРёСЏ С‚Рµ Р¶Рµ, С‡С‚Рѕ Рё РЅР° Netlify: yt-dlp РЅРµРґРѕСЃС‚СѓРїРµРЅ, РѕР±СЂР°Р±РѕС‚РєР° С‡РµСЂРµР· FFmpeg.wasm.

### Р”РµРїР»РѕР№ РІ Netlify

вњ… **РџСЂРѕРµРєС‚ РїРѕР»РЅРѕСЃС‚СЊСЋ РїРѕРґРґРµСЂР¶РёРІР°РµС‚ РґРµРїР»РѕР№ РІ Netlify!**

РџСЂРѕРµРєС‚ Р±С‹Р» РїРµСЂРµСЂР°Р±РѕС‚Р°РЅ РґР»СЏ РїРѕР»РЅРѕР№ РїРѕРґРґРµСЂР¶РєРё Netlify СЃ graceful degradation - РІСЃРµ С„СѓРЅРєС†РёРё СЂР°Р±РѕС‚Р°СЋС‚, РЅРѕ РѕР±СЂР°Р±РѕС‚РєР° Р°СѓРґРёРѕ РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ С‚РѕР»СЊРєРѕ РїСЂРё РЅР°Р»РёС‡РёРё FFmpeg.

### вњ… Р§С‚Рѕ СЂР°Р±РѕС‚Р°РµС‚ РІ Netlify

1. **РЎРєР°С‡РёРІР°РЅРёРµ С‡РµСЂРµР· RapidAPI:**
   - вњ… РЎРєР°С‡РёРІР°РЅРёРµ С‚СЂРµРєРѕРІ СЃ YouTube (РѕР±С‹С‡РЅС‹Р№ YouTube, РЅРµ Music)
   - вњ… РџРѕР»СѓС‡РµРЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…
   - вњ… РџСЂРѕСЃР»СѓС€РёРІР°РЅРёРµ С‚СЂРµРєРѕРІ

2. **Р’РµР±-РёРЅС‚РµСЂС„РµР№СЃ:**
   - вњ… Р’СЃРµ UI РєРѕРјРїРѕРЅРµРЅС‚С‹
   - вњ… Р РµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С…
   - вњ… РџСЂРѕСЃРјРѕС‚СЂ СЃРїРёСЃРєР° С‚СЂРµРєРѕРІ

3. **РћР±СЂР°Р±РѕС‚РєР° С‚СЂРµРєРѕРІ (СЃ graceful degradation):**
   - вњ… Р¤СѓРЅРєС†РёСЏ РѕР±СЂР°Р±РѕС‚РєРё СЂР°Р±РѕС‚Р°РµС‚ Р±РµР· РѕС€РёР±РѕРє
   - вљ пёЏ РћР±СЂРµР·РєР° РЅРµ РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ (С„Р°Р№Р» РєРѕРїРёСЂСѓРµС‚СЃСЏ Р±РµР· РёР·РјРµРЅРµРЅРёР№)
   - вљ пёЏ BPM РЅРµ РѕРїСЂРµРґРµР»СЏРµС‚СЃСЏ
   - вњ… РќР°СЃС‚СЂРѕР№РєРё РѕР±СЂРµР·РєРё СЃРѕС…СЂР°РЅСЏСЋС‚СЃСЏ РІ РјРµС‚Р°РґР°РЅРЅС‹С…

### вљ пёЏ РћРіСЂР°РЅРёС‡РµРЅРёСЏ РІ Netlify

1. **yt-dlp:**
   - вќЊ РќРµР»СЊР·СЏ Р·Р°РїСѓСЃРєР°С‚СЊ Р±РёРЅР°СЂРЅС‹Рµ С„Р°Р№Р»С‹ РІ serverless
   - вќЊ YouTube Music Рё РЇРЅРґРµРєСЃ.РњСѓР·С‹РєР° РЅРµРґРѕСЃС‚СѓРїРЅС‹
   - вњ… РћР±С‹С‡РЅС‹Р№ YouTube СЂР°Р±РѕС‚Р°РµС‚ С‡РµСЂРµР· RapidAPI

2. **РћР±СЂР°Р±РѕС‚РєР° Р°СѓРґРёРѕ:**
   - вљ пёЏ РћР±СЂРµР·РєР° С‚СЂРµРєРѕРІ РЅРµ РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ (С‚СЂРµР±СѓРµС‚ FFmpeg)
   - вљ пёЏ Fade in/out РЅРµ РїСЂРёРјРµРЅСЏРµС‚СЃСЏ (С‚СЂРµР±СѓРµС‚ FFmpeg)
   - вљ пёЏ РћРїСЂРµРґРµР»РµРЅРёРµ BPM РЅРµ СЂР°Р±РѕС‚Р°РµС‚ (С‚СЂРµР±СѓРµС‚ FFmpeg)
   - вњ… Р¤СѓРЅРєС†РёРё РЅРµ РїР°РґР°СЋС‚ СЃ РѕС€РёР±РєР°РјРё, СЂР°Р±РѕС‚Р°СЋС‚ gracefully

**РџРѕРґСЂРѕР±РЅРµРµ:** РЎРј. [NETLIFY_LIMITATIONS.md](./NETLIFY_LIMITATIONS.md)

### РќР°СЃС‚СЂРѕР№РєР° РґР»СЏ Netlify

1. **РџРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ РІ Netlify:**
   - `RAPIDAPI_KEY` - РІР°С€ РєР»СЋС‡ RapidAPI
   - `RAPIDAPI_HOST` - С…РѕСЃС‚ RapidAPI (РѕР±С‹С‡РЅРѕ `youtube-mp36.p.rapidapi.com`)

2. **РљРѕРЅС„РёРіСѓСЂР°С†РёСЏ СѓР¶Рµ РЅР°СЃС‚СЂРѕРµРЅР°:**
   - Р¤Р°Р№Р» `netlify.toml` СѓР¶Рµ СЃРѕРґРµСЂР¶РёС‚ РЅРµРѕР±С…РѕРґРёРјС‹Рµ РЅР°СЃС‚СЂРѕР№РєРё
   - Next.js РїР»Р°РіРёРЅ РґР»СЏ Netlify СѓСЃС‚Р°РЅРѕРІР»РµРЅ

3. **Р”РµРїР»РѕР№:**
   ```bash
   # РџРѕРґРєР»СЋС‡РёС‚Рµ СЂРµРїРѕР·РёС‚РѕСЂРёР№ Рє Netlify
   # Netlify Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё СЃРѕР±РµСЂРµС‚ РїСЂРѕРµРєС‚ РїСЂРё push РІ main РІРµС‚РєСѓ
   ```

### Р РµРєРѕРјРµРЅРґР°С†РёРё РґР»СЏ Netlify

**РџСЂРѕРµРєС‚ РіРѕС‚РѕРІ РґР»СЏ РґРµРїР»РѕСЏ РІ Netlify:**
- вњ… Р’СЃРµ С„СѓРЅРєС†РёРё СЂР°Р±РѕС‚Р°СЋС‚ Р±РµР· РѕС€РёР±РѕРє
- вњ… РЎРєР°С‡РёРІР°РЅРёРµ С‡РµСЂРµР· RapidAPI СЂР°Р±РѕС‚Р°РµС‚
- вњ… Р РµРґР°РєС‚РёСЂРѕРІР°РЅРёРµ РјРµС‚Р°РґР°РЅРЅС‹С… СЂР°Р±РѕС‚Р°РµС‚ РїРѕР»РЅРѕСЃС‚СЊСЋ
- вљ пёЏ РћР±СЂР°Р±РѕС‚РєР° Р°СѓРґРёРѕ СЂР°Р±РѕС‚Р°РµС‚ СЃ graceful degradation (Р±РµР· РѕР±СЂР°Р±РѕС‚РєРё, РЅРѕ Р±РµР· РѕС€РёР±РѕРє)

**Р”Р»СЏ РїРѕР»РЅРѕР№ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚Рё (РѕР±СЂР°Р±РѕС‚РєР° Р°СѓРґРёРѕ):**
- вњ… РСЃРїРѕР»СЊР·СѓР№С‚Рµ VPS РёР»Рё РІС‹РґРµР»РµРЅРЅС‹Р№ СЃРµСЂРІРµСЂ
- вњ… РЈСЃС‚Р°РЅРѕРІРёС‚Рµ FFmpeg Рё yt-dlp РЅР° СЃРµСЂРІРµСЂРµ
- вњ… Р”РµРїР»РѕР№С‚Рµ Next.js РїСЂРёР»РѕР¶РµРЅРёРµ РЅР° СЃРµСЂРІРµСЂ
- вњ… Р’СЃРµ С„СѓРЅРєС†РёРё Р±СѓРґСѓС‚ СЂР°Р±РѕС‚Р°С‚СЊ РїРѕР»РЅРѕСЃС‚СЊСЋ

**Р‘РёРЅР°СЂРЅРёРєРё РІ `bin/`:**
- вњ… РџРѕР»РµР·РЅС‹ РґР»СЏ Р»РѕРєР°Р»СЊРЅРѕР№ СЂР°Р·СЂР°Р±РѕС‚РєРё (РїРѕР»РЅР°СЏ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚СЊ)
- вњ… РџРѕР»РµР·РЅС‹ РґР»СЏ РґРµРїР»РѕСЏ РЅР° VPS/СЃРµСЂРІРµСЂ (РїРѕР»РЅР°СЏ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚СЊ)
- вљ пёЏ РќРµ РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ РІ Netlify (РЅРѕ РїСЂРѕРµРєС‚ СЂР°Р±РѕС‚Р°РµС‚ gracefully)

## РЈСЃС‚СЂР°РЅРµРЅРёРµ РЅРµРїРѕР»Р°РґРѕРє

### РџСЂРѕР±Р»РµРјС‹ СЃ FFmpeg

1. **Windows:**
   - РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ FFmpeg СѓСЃС‚Р°РЅРѕРІР»РµРЅ Рё РґРѕСЃС‚СѓРїРµРЅ РІ PATH
   - РџСЂРѕРІРµСЂСЊС‚Рµ РІРµСЂСЃРёСЋ: `ffmpeg -version`
   - РР»Рё СѓРєР°Р¶РёС‚Рµ РїСѓС‚СЊ С‡РµСЂРµР· `FFMPEG_PATH` РёР»Рё `config.json`

2. **Linux:**
   - РЈСЃС‚Р°РЅРѕРІРёС‚Рµ С‡РµСЂРµР· РїР°РєРµС‚РЅС‹Р№ РјРµРЅРµРґР¶РµСЂ: `sudo apt-get install ffmpeg`
   - РџСЂРѕРІРµСЂСЊС‚Рµ РІРµСЂСЃРёСЋ: `ffmpeg -version`
   - Р•СЃР»Рё СѓСЃС‚Р°РЅРѕРІР»РµРЅ РІ РЅРµСЃС‚Р°РЅРґР°СЂС‚РЅРѕРј РјРµСЃС‚Рµ, СѓРєР°Р¶РёС‚Рµ РїСѓС‚СЊ С‡РµСЂРµР· `FFMPEG_PATH`

3. **РџСѓС‚СЊ РЅРµ РЅР°Р№РґРµРЅ:**
   - РџСЂРѕРІРµСЂСЊС‚Рµ, С‡С‚Рѕ РїСѓС‚СЊ СѓРєР°Р·С‹РІР°РµС‚ РЅР° РґРёСЂРµРєС‚РѕСЂРёСЋ СЃ `ffmpeg` Рё `ffprobe`
   - РќР° Windows: `C:\ffmpeg\bin\` (РґРѕР»Р¶РЅС‹ Р±С‹С‚СЊ `ffmpeg.exe` Рё `ffprobe.exe`)
   - РќР° Linux: `/usr/bin/` (РґРѕР»Р¶РЅС‹ Р±С‹С‚СЊ `ffmpeg` Рё `ffprobe`)

### РџСЂРѕР±Р»РµРјС‹ СЃ yt-dlp

1. **Windows:**
   - РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ `yt-dlp.exe` РЅР°С…РѕРґРёС‚СЃСЏ РІ РїР°РїРєРµ `bin/` РїСЂРѕРµРєС‚Р°

2. **Linux:**
   - РЈСЃС‚Р°РЅРѕРІРёС‚Рµ С‡РµСЂРµР· pip: `pip install yt-dlp`
   - РР»Рё СЃРєР°С‡Р°Р№С‚Рµ Р±РёРЅР°СЂРЅРёРє РІ РїР°РїРєСѓ `bin/` Рё СЃРґРµР»Р°Р№С‚Рµ РёСЃРїРѕР»РЅСЏРµРјС‹Рј: `chmod +x bin/yt-dlp`
   - РџСЂРѕРІРµСЂСЊС‚Рµ: `yt-dlp --version`

### РџСЂРѕР±Р»РµРјС‹ СЃ YouTube

1. **RapidAPI РЅРµ СЂР°Р±РѕС‚Р°РµС‚:**
   - РџСЂРѕРІРµСЂСЊС‚Рµ РїСЂР°РІРёР»СЊРЅРѕСЃС‚СЊ API РєР»СЋС‡Р°
   - РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ Сѓ РІР°СЃ РµСЃС‚СЊ Р°РєС‚РёРІРЅР°СЏ РїРѕРґРїРёСЃРєР° РЅР° RapidAPI
   - РџСЂРёР»РѕР¶РµРЅРёРµ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїРѕРїСЂРѕР±СѓРµС‚ yt-dlp РєР°Рє fallback

2. **yt-dlp РЅРµ СЂР°Р±РѕС‚Р°РµС‚:**
   - РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ yt-dlp СѓСЃС‚Р°РЅРѕРІР»РµРЅ Рё РґРѕСЃС‚СѓРїРµРЅ
   - РћР±РЅРѕРІРёС‚Рµ yt-dlp: `pip install --upgrade yt-dlp` (Linux) РёР»Рё СЃРєР°С‡Р°Р№С‚Рµ РЅРѕРІСѓСЋ РІРµСЂСЃРёСЋ (Windows)
   - РџСЂРѕРІРµСЂСЊС‚Рµ, С‡С‚Рѕ FFmpeg СѓСЃС‚Р°РЅРѕРІР»РµРЅ (С‚СЂРµР±СѓРµС‚СЃСЏ РґР»СЏ РєРѕРЅРІРµСЂС‚Р°С†РёРё РІ MP3)

### РџСЂРѕР±Р»РµРјС‹ СЃ FTP

1. РџСЂРѕРІРµСЂСЊС‚Рµ РїСЂР°РІРёР»СЊРЅРѕСЃС‚СЊ FTP РЅР°СЃС‚СЂРѕРµРє
2. РЈР±РµРґРёС‚РµСЃСЊ, С‡С‚Рѕ СЃРµСЂРІРµСЂ РїРѕРґРґРµСЂР¶РёРІР°РµС‚ РІС‹Р±СЂР°РЅРЅС‹Р№ С‚РёРї СЃРѕРµРґРёРЅРµРЅРёСЏ
3. РџСЂРѕРІРµСЂСЊС‚Рµ С„Р°Р№СЂРІРѕР» Рё РЅР°СЃС‚СЂРѕР№РєРё Р±РµР·РѕРїР°СЃРЅРѕСЃС‚Рё

### РџСЂРѕР±Р»РµРјС‹ СЃ РїР°РјСЏС‚СЊСЋ

1. Р”Р»СЏ Р±РѕР»СЊС€РёС… С„Р°Р№Р»РѕРІ СѓРІРµР»РёС‡СЊС‚Рµ Р»РёРјРёС‚С‹ Node.js:
   ```bash
   node --max-old-space-size=4096 yarn dev
   ```

## Р›РёС†РµРЅР·РёСЏ

MIT License

## РџРѕРґРґРµСЂР¶РєР°

РџСЂРё РІРѕР·РЅРёРєРЅРѕРІРµРЅРёРё РїСЂРѕР±Р»РµРј СЃРѕР·РґР°Р№С‚Рµ issue РІ СЂРµРїРѕР·РёС‚РѕСЂРёРё РїСЂРѕРµРєС‚Р°.

